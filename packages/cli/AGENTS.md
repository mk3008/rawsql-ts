# @rawsql-ts/cli

## Status

This package is a **placeholder for the future CLI tooling** around rawsql-ts.  
No published commands or stable APIs exist yet. Use this file only as guidance for future work.

## Intended Scope

The CLI will eventually provide:

- **Scaffolding** for SQL-heavy Node.js projects:
  - generating test fixtures and repository skeletons,
  - wiring pg-testkit / sqlite-testkit into existing apps.
- **DDL utilities**:
  - loading/extracting schema definitions from databases or local files,
  - comparing snapshots to generate migration scripts.
- **Test harness helpers**:
  - creating initial `ddl/` and `tests/` layouts,
  - bootstrapping example repositories and fixture sets.

All of these must operate in a way that respects **Zero Table Dependency (ZTD)**:  
even when the CLI inspects a live database, the goal is to produce definitions and fixtures, not to mutate physical tables during tests.

## Design Principles

1. **No runtime dependency on CLI in production code.**  
   Everything generated by the CLI must be plain TypeScript/SQL that can be committed and maintained without the tool.

2. **Testkit-first.**  
   The CLI should generate fixtures, DDL, and repository code that works out of the box with:
   - `@rawsql-ts/testkit-core`
   - `@rawsql-ts/pg-testkit`
   - `@rawsql-ts/sqlite-testkit`

3. **AST-driven, not regex-driven.**  
   When inspecting or transforming SQL, call into the `rawsql-ts` parser and helpers instead of adding ad-hoc string manipulation.

4. **Non-destructive by default.**  
   CLI commands must:
   - never apply migrations to production databases,
   - ask for explicit confirmation before mutating any live schema,
   - prefer “generate a script” over “apply immediately”.

5. **Clear separation of concerns.**  
   - DBMS-specific extraction lives behind adapter interfaces.
   - Core CLI flow should not hard-code Postgres/SQLite-specific behavior.

## Non-Goals

- No long-running daemons or background services.
- No ORM-specific code generation baked into the core CLI (ORM integrations must be optional plugins or templates).
- No attempt to replace existing full-featured migration tools; the focus is **ZTD-friendly workflows** and test-centric scaffolding.

## Future Contributor Checklist

When adding features to this package:

1. Confirm the command does **not** introduce a runtime dependency on `@rawsql-ts/cli` for production code.
2. Prefer AST-powered analysis from `rawsql-ts/core` over regex processing.
3. Keep DB access optional and clearly flagged (e.g., `--introspect-db`).
4. Provide:
   - a README section with usage examples,
   - tests for each command’s main code path.
5. Ensure generated files are idempotent and safe to re-run (re-scaffold) without corrupting existing projects.
