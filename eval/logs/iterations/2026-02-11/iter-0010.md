# Iteration 0010

- Original iteration number: 10
- Source: eval/IMPROVEMENT_PLAN.ja.md (frozen)

* Iteration: 10
* Target item: 1. SQLカタログ単体テストの改善（ZTD / Mapping）
* Change applied: P10（`eval/runner.ts` の `ai_execution` に marker-only 不合格条件を追加）
* Expected effect: `tests/__eval_ai_marker__.txt` のみ変更された場合を成功扱いにせず、偽陽性を減らす
* Observed effect:
  - コマンド: `pnpm exec ts-node eval/loop.ts --loop 1 --scenario crud-basic --report-prefix eval/reports/loop-task1-p10`
  - 生成物:
    - `eval/reports/loop-task1-p10-20260210075234-01.json`
    - `eval/reports/loop-task1-p10-summary-20260210075234.json`
    - `eval/reports/loop-task1-p10-20260210075930-01.json`
    - `eval/reports/loop-task1-p10-summary-20260210075930.json`
  - 実装観測:
    - marker定義を `EVAL_MARKER_RELATIVE_PATH = "tests/__eval_ai_marker__.txt"` に固定
    - `meta.marker_only` と `meta.non_marker_touched_count` を `ai_execution` に追加
    - marker-only のとき `effectiveWrite=false` となる判定を追加
  - report観測:
    - `checks.ai_execution.meta.marker_only = false`（`loop-task1-p10-20260210075234-01.json`）
    - `checks.ai_execution.meta.non_marker_touched_count = 9`（`loop-task1-p10-20260210075234-01.json`）
    - `checks.ai_execution.passed = true`（`loop-task1-p10-20260210075234-01.json`）
    - `checks.ai_execution.meta.marker_only = true`（`loop-task1-p10-20260210075930-01.json`）
    - `checks.ai_execution.meta.non_marker_touched_count = 0`（`loop-task1-p10-20260210075930-01.json`）
    - `checks.ai_execution.passed = false`（`loop-task1-p10-20260210075930-01.json`）
    - summary `iterations[0].failed_categories = ["ai_execution"]`（`loop-task1-p10-summary-20260210075930.json`）
* Verdict: Effective
* If Ineffective: N/A
* Proposal stack:
  - Pending:
    - P13: marker-only ケースを再現する入力制約またはテスト補助を追加し、`marker_only=true` 時に `ai_execution` が fail になることを観測で確定する。
      - 期待効果/検証: P10の実行時経路を観測で確証 / marker-only再現ランで `checks.ai_execution.passed=false` を確認。
    - P11: blocker語彙を report fixture で固定し、検出回帰テスト（ユニット）を追加する。
      - 期待効果/検証: 語彙変化で検出退行しない / 既知blocker文を入力したテストが `blocker_detected=true` で通ることを確認。
    - P12: `ai_execution` に「blocker未検出でも提案のみで実ファイル編集が不足」の判定メタを追加する。
      - 期待効果/検証: 実作業未完了ケースの可視化 / summaryで偽陽性パターンを機械抽出できることを確認。
  - Dropped as noise:
    - なし
  - Dropped as waste:
    - なし