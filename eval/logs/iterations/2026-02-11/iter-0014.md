# Iteration 0014

- Original iteration number: 14
- Source: eval/IMPROVEMENT_PLAN.ja.md (frozen)

* Iteration: 14
* Target item: 1. SQLカタログ単体テストの改善（ZTD / Mapping）
* Change applied: P15（`eval/loop.ts` summary aggregate に dirty_worktree 統計を追加）
* Expected effect: loop summary だけで dirty worktree 混入の有無と失敗件数を機械判定できる
* Observed effect:
  - 実装:
    - `aggregate.dirty_worktree_present_count`
    - `aggregate.dirty_worktree_failed_count`
    を追加（Observed）
  - 検証コマンド（strict）:
    - `EVAL_REQUIRE_CLEAN_TREE=1 pnpm exec ts-node eval/loop.ts --loop 1 --scenario crud-basic --report-prefix eval/reports/loop-task1-next`
  - 生成物（Observed）:
    - `eval/reports/loop-task1-next-summary-20260210122520.json`
    - `eval/reports/loop-task1-next-20260210122520-01.json`
  - summary観測（Observed）:
    - `aggregate.dirty_worktree_present_count = 1`
    - `aggregate.dirty_worktree_failed_count = 1`
  - 備考（Observed）:
    - 初回検証は未コミット差分（`eval/loop.ts`）が存在したため `dirty_worktree_required_clean` で停止。
    - 変更コミット後に同コマンドを再実行したところ、`run_command_start` 以降が長時間無出力となり完了イベントを観測できず、プロセス停止で打ち切り（Not observed）。
* Verdict: Effective
* If Ineffective: N/A
* Proposal stack:
  - Pending:
    - P14: dirty_worktree failure の分類を proposal 抽出時に専用カテゴリとして扱い、template/library 提案への誤誘導を抑制する。
      - 期待効果/検証: dirty 起因失敗で不要な改善案が出にくくなる / failure cluster の上位提案が `dirty_worktree` 文脈に一致することを確認。
    - P16: strict モード時に次アクション（`git status --short` など）を report error に定型文で付与する。
      - 期待効果/検証: 自動運転停止時の復旧手順を短縮 / report.error に次コマンドが含まれることを確認。
    - P17: `run_command_start` 後の長時間無出力ケースを診断するため、runner 実行の wall-time timeout / timeout理由メタを summary に追加する。
      - 期待効果/検証: ハング時の停止点を機械判定 / summary に timeout reason が記録されることを確認。
  - Dropped as noise:
    - なし
  - Dropped as waste:
    - なし